## 索引

[介绍](https://mp.weixin.qq.com/s/YMbRJwyjutGMD1KpI_fS0A)

### 聚集索引

叶子节点存储行记录(row),所以，InnoDB索引和记录是存储在一起的，而MyISAM的索引和记录是分开存储的

InnoDB的每一个表都会有聚集索引：
1. 如果表定义了PK，则PK就是聚集索引；
2. 如果表没有定义PK，则第一个非空unique列是聚集索引；
3. 否则，InnoDB会创建一个隐藏的row-id作为聚集索引；
索引的结构是B+树   

### 普通索引
叶子节点存储了PK的值,所以，InnoDB的普通索引，实际上会扫描两遍,第一遍，由普通索引找到PK；第二遍，由PK找到行记录；

### 什么是局部性原理？

1. 内存读写快，磁盘读写慢，而且慢很多
2. 磁盘预读：磁盘读写并不是按需读取，而是按页预读，一次会读一页的数据(4k)，每次加载更多的数据，如果未来要读取的数据就在这一页中，可以避免未来的磁盘IO，提高效率
3. 局部性原理：软件设计要尽量遵循“数据读取集中”与“使用到一个数据，大概率会使用其附近的数据”，这样磁盘预读能充分提高磁盘IO

### 数据库索引为什么使用B+树？ 为什么不是Hash,B树

1. Hash(O(1))比树(O(log(n))),增删改查都快,但是不适合SQL语句,(InnoDB并不支持哈希索引)
2. B树(二叉搜索树): 1)当数据量大的时候，树的高度会比较高，数据量大的时候，查询会比较慢,2)每个节点只存储一个记录，可能导致一次查询有很多次磁盘IO
3. B-树(m叉搜索): 叶子节点，非叶子节点，都存储数据；中序遍历,获取所有节点
4. B+树: 1)非叶子节点不再存储数据，数据只存储在同一层的叶子节点上 2)**叶子之间，增加了链表**，获取所有节点，不再需要中序遍历 3)适合范围查找

